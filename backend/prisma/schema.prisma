generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Enum de alérgenos
enum Alergenos {
  MILK
  EGGS
  FISH
  CRUSTACEAN_SHELLFISH
  TREE_NUTS
  PEANUTS
  WHEAT
  SOYBEANS
  SESAME
  MUSTARD
}

// Enum de ingredientes (definido previamente)
enum Ingredientes {
  TOMATO
  CHEESE
  LETTUCE
  CHICKEN
  BEEF
  ONION
  GARLIC
  PEPPER
  SALT
  OLIVE_OIL
  BUTTER
  CARROT
  POTATO
  RICE
  PASTA
  MILK
  EGG
  FLOUR
  SUGAR
  APPLE
  BANANA
  STRAWBERRY
  ORANGE
  SPINACH
  BROCCOLI
  CUCUMBER
  ZUCCHINI
  CORN
  PEAS
  MUSHROOM
  BASIL
  CILANTRO
  THYME
  ROSEMARY
  PARSLEY
  LEMON
  LIME
  GINGER
  CINNAMON
  HONEY
  VINEGAR
  SOY_SAUCE
  YOGURT
  CREAM
  BACON
  HAM
  SHRIMP
  SALMON
  TUNA
  ALMOND
  WALNUT
  PISTACHIO
  OREGANO
  CHILI_PEPPER
  TURMERIC
  CUMIN
  CORIANDER
  CLOVES
  BAY_LEAF
  MUSTARD_SEED
  FENNEL
  ANISE
  MINT
  COCONUT_MILK
  LENTILS
  CHICKPEAS
  AVOCADO
  PINEAPPLE
  BELL_PEPPER
  SCALLIONS
  CABBAGE
  ARTICHOKE
  ASPARAGUS
  BRUSSELS_SPROUTS
  BLUEBERRIES
  RASPBERRIES
  WATERMELON
  PEACH
  PEAR
  MANGO
  KIWI
  PUMPKIN
  SWEET_POTATO
  CAULIFLOWER
  GREEN_BEANS
  BLACK_BEANS
  RED_BEANS
  QUINOA
  BARLEY
  OATS
  SESAME_SEEDS
  SUNFLOWER_SEEDS
  PUMPKIN_SEEDS
  MAPLE_SYRUP
  CHOCOLATE
  WHITE_CHOCOLATE
  DARK_CHOCOLATE
  COCONUT
  CASHEWS
  MACADAMIA_NUTS
  RICOTTA
  MOZZARELLA
  PARMESAN
  GOUDA
  BRIE
  CHEDDAR
  PROVOLONE
  CAMEMBERT
  FETA
  GRUYERE
  SWISS_CHEESE
  GORGONZOLA
  ROQUEFORT
  COTTAGE_CHEESE
  SOUR_CREAM
  MAYONNAISE
  MUSTARD
  KETCHUP
  BBQ_SAUCE
  WORCESTERSHIRE_SAUCE
  HOT_SAUCE
  TABASCO
  PESTO
  MARINARA_SAUCE
  TAHINI
  HOISIN_SAUCE
  FISH_SAUCE
  APPLE_CIDER_VINEGAR
  BALSAMIC_VINEGAR
  RED_WINE_VINEGAR
  WHITE_WINE_VINEGAR
  CIDER
  GHEE
  CLARIFIED_BUTTER
  VEGETABLE_OIL
  CANOLA_OIL
  PEANUT_OIL
  COCONUT_OIL
  GRAPESEED_OIL
  SESAME_OIL
  SUNFLOWER_OIL
  CORN_OIL
  LARD
  SHORTENING
  BAKING_POWDER
  BAKING_SODA
  YEAST
  CORNSTARCH
  TAPIOCA
  GELATIN
  AGAR_AGAR
  CREAM_OF_TARTAR
  ARROWROOT
  VANILLA_EXTRACT
  ALMOND_EXTRACT
  LEMON_ZEST
  ORANGE_ZEST
  SAFFRON
  PAPRIKA
  SMOKED_PAPRIKA
  NUTMEG
  ALLSPICE
  CARDAMOM
  STAR_ANISE
  SUMAC
  FENUGREEK
  WHITE_PEPPER
  BLACK_PEPPER
  PINK_PEPPERCORNS
  GREEN_PEPPERCORNS
  CELERY_SALT
  ONION_POWDER
  GARLIC_POWDER
  GARAM_MASALA
  HERBES_DE_PROVENCE
  ITALIAN_SEASONING
  TACO_SEASONING
  RANCH_SEASONING
  CINNAMON_STICK
  CURRY_LEAVES
  TAMARIND_PASTE
  GARAM
  DILL
  CHIVES
  LAVENDER
  CRESS
  WATERCRESS
  SORREL
  ENDIVE
  ESCAROLE
  CHARD
  BEETROOT
  TURNIP
  RADISH
  PARSNIP
  RUTABAGA
  FENNEL_BULB
  KOHLRABI
  OKRA
  GOURD
  BITTER_MELON
  SQUASH
  ACORN_SQUASH
  BUTTERNUT_SQUASH
  SPAGHETTI_SQUASH
  TARO
  YAM
  JICAMA
  DAIKON_RADISH
  LOTUS_ROOT
  BAMBOO_SHOOTS
  SUGAR_SNAP_PEAS
  SNOW_PEAS
  FAVA_BEANS
  NAVY_BEANS
  PINTO_BEANS
  GREAT_NORTHERN_BEANS
  EDAMAME
  SOYBEANS
  WHITE_KIDNEY_BEANS
  BORLOTTI_BEANS
  LIMA_BEANS
  BLACK_EYED_PEAS
  SPLIT_PEAS
  DRIED_PEAS
  BEAN_SPROUTS
  ALFALFA_SPROUTS
  MUNG_BEANS
  ENOKI_MUSHROOM
  SHIITAKE_MUSHROOM
  OYSTER_MUSHROOM
  PORTOBELLO_MUSHROOM
  CREMINI_MUSHROOM
  BUTTON_MUSHROOM
  PORCINI_MUSHROOM
  CHANTERELLE_MUSHROOM
  MOREL_MUSHROOM
  KING_OYSTER_MUSHROOM
  TRUFFLES
  TRUFFLE_OIL
  NOPALES
  JACKFRUIT
  DURION
  LYCHEE
  DRAGON_FRUIT
  STAR_FRUIT
  PASSION_FRUIT
  GUAVA
  PAPAYA
  RAMBUTAN
  BREADFRUIT
  LONGAN
  PERSIMMON
  HUCKLEBERRY
  ELDERBERRY
  MULBERRY
  BLACK_CURRANT
  RED_CURRANT
  WHITE_CURRANT
  CRANBERRIES
  FIGS
  MEDJOOL_DATE
  RICE_NOODLES
  GLASS_NOODLES
  UDON_NOODLES
  RAMEN_NOODLES
  EGG_NOODLES
  FETTUCCINE
  PENNE
  FARFALLE
  MACARONI
  RAVIOLI
  TORTELLINI
  ORZO
  GNOCCHI
  COUSCOUS
  BULGUR
  FREKKEH
  SPELT
  WHEAT_BERRIES
  MILLET
  SORGHUM
  TEFF
  CHIA_SEEDS
  FLAX_SEEDS
  HEMP_SEEDS
  POPPY_SEEDS
  AMARANTH
  BUCKWHEAT
  CARAWAY
  SAUERKRAUT
  KIMCHI
  PICKLES
  FERMENTED_BEANS
  MISO_PASTE
  TEMPEH
  TOFU
  SEITAN
  TVP
  JACKFRUIT_MEAT
  PLANTAIN
  TAPENADE
  CAPERS
  GHERKINS
  DATES
  GOLDEN_RAISINS
  PRUNES
  CURRANTS
  ZANTE_CURRANTS
  SULTANAS
  POMEGRANATE
  POMEGRANATE_SEEDS
  AGAVE_SYRUP
  DATE_SUGAR
  BROWN_SUGAR
  POWDERED_SUGAR
  ICING_SUGAR
  MUSCOVADO_SUGAR
  TURBINADO_SUGAR
  DEMERARA_SUGAR
  STEVIA
  SUCANAT
  ERYTHRITOL
  XYLITOL
  COCONUT_SUGAR
  PALM_SUGAR
  SEAWEED
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String
  role      String // e.g., 'user' or 'admin'
  createdAt DateTime @default(now())
}

model Event {
  id             Int              @id @default(autoincrement())
  name           String
  date           DateTime
  location       String
  budget         Float
  description    String?
  durationHours  Int? // Temporada opcional para evitar errores de migración
  asistentes     Asistentes[] // Relación con asistentes
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  Menu           Menu[]
  MenuConfirmado MenuConfirmado[]
}

model Asistentes {
  id        Int                 @id @default(autoincrement())
  name      String // Nombre completo del asistente
  country   String // País de origen
  email     String? // Correo electrónico (opcional)
  phone     String? // Teléfono (opcional)
  eventId   Int
  event     Event               @relation(fields: [eventId], references: [id])
  alergenos AlergenoAsistente[]
}

model AlergenoAsistente {
  id          Int        @id @default(autoincrement())
  asistenteId Int
  asistente   Asistentes @relation(fields: [asistenteId], references: [id])
  alergeno    Alergenos
}

model Menu {
  id      Int     @id @default(autoincrement())
  name    String
  eventId Int
  event   Event   @relation(fields: [eventId], references: [id])
  platos  Plato[]
}

model Plato {
  id               Int                @id @default(autoincrement())
  name             String
  isVegan          Boolean
  isGlutenFree     Boolean
  precio           Float
  menuId           Int? // Cambio: Hacer opcional el campo menuId
  menu             Menu?              @relation(fields: [menuId], references: [id])
  ingredientes     IngredientePlato[]
  origen           String // Nuevo campo para identificar el país de origen del plato
  MenuConfirmado   MenuConfirmado?    @relation(fields: [menuConfirmadoId], references: [id])
  menuConfirmadoId Int?
}

model IngredientePlato {
  id          Int          @id @default(autoincrement())
  platoId     Int
  plato       Plato        @relation(fields: [platoId], references: [id])
  ingrediente Ingredientes
}

model MenuConfirmado {
  id          Int      @id @default(autoincrement())
  eventId     Int
  event       Event    @relation(fields: [eventId], references: [id])
  platos      Plato[] // Se elimina `@relation(references: [id])`
  confirmedAt DateTime @default(now())
}
